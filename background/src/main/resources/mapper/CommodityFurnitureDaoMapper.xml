<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ka.store.dao.CommodityFurnitureDao">

    <resultMap id="furniture" type="com.ka.store.pojo.commodity.furniture.CommodityFurniture">
        <id column="id" property="id"/>
        <result property="name" column="name"/>
        <result property="price" column="price"/>
        <result property="commodity_id" column="commodity_id"/>
        <result property="furniture_material" column="furniture_material"/>
        <result property="scene" column="scene"/>
        <result property="function_type" column="function_type"/>
        <result property="furniture_weight" column="furniture_weight"/>
        <result property="furniture_area" column="furniture_area"/>
        <result property="furniture_style" column="furniture_style"/>
        <result property="brand" column="brand"/>
        <result property="room" column="room"/>
        <association property="commodity" javaType="com.ka.store.pojo.commodity.Commodity">
            <id property="id" column="id"/>
            <result column="commodity_id" property="commodity_id"/>
            <result column="name" property="name"/>
            <result column="merchant_id" property="merchant_id"/>
            <result column="price" property="price"/>
            <result column="category" property="category"/>
            <result column="main_img" property="main_img"/>
            <result column="introduce" property="introduce"/>
            <association property="sales_commodity" javaType="com.ka.store.pojo.sale.Sales_commodity">
                <id column="id" property="id"/>
                <result column="commodity_id" property="commodity_id"/>
                <result column="sales_num" property="sales_num"/>
                <result column="ave_grade" property="ave_grade"/>
            </association>
        </association>
    </resultMap>


    <select id="selectAllFurniture"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
    </select>

    <insert id="insertFurniture" parameterType="com.ka.store.pojo.commodity.furniture.CommodityFurniture">
        insert into commodity_furniture(name,price,commodity_id,furniture_material,scene,function_type,furniture_weight,furniture_area,furniture_style,brand,room)
            values(#{name},#{price},#{commodity_id},#{furniture_material},#{scene},#{function_type},#{furniture_weight},#{furniture_area},#{furniture_style},#{brand},#{room})
    </insert>

    <delete id="deleteFurnitureById" parameterType="String">
        delete from commodity_furniture where commodity_id=#{commodity_id}
    </delete>

    <update id="updateFurnitureById" parameterType="com.ka.store.pojo.commodity.furniture.CommodityFurniture">
        update commodity_furniture
            <set>
                <if test="name!=null and name!=''">name=#{name}</if>
                <if test="price!=null and price!=''">,price=#{price}</if>
                <if test="furniture_material!=null and furniture_material!=''">,furniture_material=#{furniture_material}</if>
                <if test="scene!=null and scene!=''">,scene=#{scene}</if>
                <if test="function_type!=null and function_type!=''">,function_type=#{function_type}</if>
                <if test="furniture_weight!=null and furniture_weight!=''">,furniture_weight=#{furniture_weight}</if>
                <if test="furniture_area!=null and furniture_area!=''">,furniture_area=#{furniture_area}</if>
                <if test="furniture_style!=null and furniture_style!=''">,furniture_style=#{furniture_style}</if>
                <if test="brand!=null and brand!=''">,brand=#{brand}</if>
                <if test="room!=null and room!=''">,room=#{room}</if>
            </set>
            where commodity_id=#{commodity_id}
    </update>

    <select id="selectFurnitureById" resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id where f.commodity_id=#{commodity_id}
    </select>

    <select id="selectFurnitureByKeyword" parameterType="String" resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
    </select>

    <select id="selectFurnitureOrderPrice"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by f.price desc
    </select>
    <select id="selectFurnitureOrderPriceUp"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by f.price
    </select>

    <select id="selectByFurnitureOrderBySaleNumUp"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by sc.sales_num
    </select>
    <select id="selectByFurnitureOrderBySaleNumDown"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by sc.sales_num desc
    </select>

    <select id="selectByFurnitureOrderByScoreUp"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by sc.ave_grade+0
    </select>
    <select id="selectByFurnitureOrderByScoreDown"  resultMap="furniture">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            order by sc.ave_grade+0 desc
    </select>


    <select id="selectFurnitureOrderBySaleNumUpAndKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by sc.sales_num
    </select>
    <select id="selectFurnitureOrderBySaleNumDownAndKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by sc.sales_num desc
    </select>

    <select id="selectByFurnitureOrderByScoreDownByKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by sc.ave_grade+0
    </select>
    <select id="selectByFurnitureOrderByScoreUpByKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by sc.ave_grade+0 desc
    </select>

    <select id="selectByFurnitureOrderByPriceDownByKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by f.price desc
    </select>
    <select id="selectByFurnitureOrderByPriceUpByKeyword"  resultMap="furniture" parameterType="String">
        select * from commodity_furniture f
            left join commodity c on f.commodity_id=c.commodity_id
            left join sales_commodity sc on f.commodity_id=sc.commodity_id
            where f.function_type=#{keyword} or f.room=#{keyword} or f.furniture_style=#{keyword} or f.brand=#{keyword}
            order by f.price
    </select>

    <select id="selectFurnitureType" resultType="String">
        select distinct function_type from commodity_furniture
    </select>
    <select id="selectFurnitureStyle" resultType="String">
        select distinct furniture_style from commodity_furniture
    </select>
    <select id="selectFurnitureBrand" resultType="String">
        select distinct brand from commodity_furniture
    </select>



</mapper>